{% extends "base.html" %}

{% block title %}ç»Ÿè®¡æŠ¥è¡¨{% endblock %}

{% block content %}
<div class="reports-page">
    <div class="page-header">
        <h1>ğŸ“Š ç»Ÿè®¡æŠ¥è¡¨</h1>
    </div>

    <div class="section">
        <h2>å®¢æˆ·æŠ¥è¡¨</h2>
        <form method="GET" style="margin-bottom: 2rem;">
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">é€‰æ‹©å®¢æˆ·</label>
                    <select name="customer" class="form-select" onchange="this.form.submit()">
                        <option value="">è¯·é€‰æ‹©å®¢æˆ·...</option>
                        {% for c in customers %}
                        <option value="{{ c }}" {% if customer == c %}selected{% endif %}>{{ c }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </form>

        {% if customer and orders %}
        <div style="margin-top: 2rem;">
            <h3>{{ customer }} çš„è®¢å•ç»Ÿè®¡</h3>
            <div class="table-container" style="max-height: 600px;">
                <table>
                    <thead>
                        <tr>
                            <th>è®¢å•å·</th>
                            <th>è®¢å•æ—¥æœŸ</th>
                            <th>çŠ¶æ€</th>
                            <th>ç”Ÿäº§ç±»å‹</th>
                            <th>é¢„è®¡äº¤è²¨</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for order in orders %}
                        <tr>
                            <td class="order-id">
                                <a href="{{ url_for('tracking_bp.order_detail', order_number=order.order_number) }}">
                                    #{{ order.order_number }}
                                </a>
                            </td>
                            <td class="date">{{ order.order_date }}</td>
                            <td>
                                <span class="status-badge">{{ order.current_status }}</span>
                                <span class="light-emoji">
                                    {% if order.status_light == 'red' %}ğŸ”´
                                    {% elif order.status_light == 'yellow' %}ğŸŸ¡
                                    {% else %}ğŸŸ¢{% endif %}
                                </span>
                            </td>
                            <td>{{ order.production_type or '-' }}</td>
                            <td class="date">{{ order.expected_delivery_date or '-' }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% elif customer %}
        <div class="empty-state">
            <p>è¯¥å®¢æˆ·æš‚æ— è®¢å•</p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

