<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ë®ÇÂñÆÊµÅÁ®ãËøΩËπ§Á≥ªÁµ± - ÊúÄÁµÇÁâà</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #fafafa;
            --card: #ffffff;
            --text: #171717;
            --text-2: #525252;
            --text-3: #a3a3a3;
            --border: #e5e5e5;
            --blue: #2563eb;
            --red: #dc2626;
            --red-bg: #fef2f2;
            --yellow: #f59e0b;
            --yellow-bg: #fffbeb;
            --green: #10b981;
            --green-bg: #f0fdf4;
            --gray: #6b7280;
            --gray-bg: #f9fafb;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.5;
        }
        
        /* Header */
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            max-width: 1900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .title {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        .search-box {
            flex: 1;
            max-width: 400px;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: var(--bg);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 0.5rem 1rem;
            transition: all 0.2s;
        }
        
        .search-box:focus-within {
            border-color: var(--blue);
        }
        
        .search-box input {
            flex: 1;
            border: none;
            outline: none;
            background: transparent;
            font-size: 0.9rem;
        }
        
        /* Container */
        .container {
            max-width: 1900px;
            margin: 0 auto;
            padding: 1.5rem 2rem;
        }
        
        /* Stats */
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .stat {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem 1.25rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .stat:hover {
            border-color: var(--blue);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        
        .stat-icon {
            font-size: 1.75rem;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--text-2);
            margin-bottom: 0.25rem;
        }
        
        .stat-value {
            font-size: 1.4rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .stat.red .stat-value { color: var(--red); }
        .stat.yellow .stat-value { color: var(--yellow); }
        .stat.green .stat-value { color: var(--green); }
        
        /* Stage Filters */
        .stage-filters {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .stage-filter {
            position: relative;
        }
        
        .stage-btn {
            padding: 0.5rem 1rem;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .stage-btn:hover {
            border-color: var(--blue);
        }
        
        .stage-btn.active {
            background: var(--blue);
            border-color: var(--blue);
            color: white;
        }
        
        .stage-btn.pending {
            background: var(--blue);
            border-color: var(--blue);
            color: white;
        }
        
        .stage-count {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            background: rgba(0,0,0,0.1);
            padding: 0.125rem 0.375rem;
            border-radius: 4px;
        }
        
        .stage-btn.active .stage-count,
        .stage-btn.pending .stage-count {
            background: rgba(255,255,255,0.2);
        }
        
        /* Substatus Dropdown */
        .substatus-dropdown {
            display: none;
            position: absolute;
            top: calc(100% + 0.5rem);
            left: 0;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 0.5rem;
            min-width: 220px;
            z-index: 50;
        }
        
        .substatus-dropdown.show {
            display: block;
        }
        
        .substatus-label {
            font-size: 0.7rem;
            color: var(--text-3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 0.5rem 0.75rem;
            font-weight: 600;
        }
        
        .substatus-option {
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.85rem;
        }
        
        .substatus-option:hover {
            background: var(--bg);
        }
        
        .substatus-option.active {
            background: var(--blue);
            color: white;
        }
        
        .substatus-option .count {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-3);
        }
        
        .substatus-option.active .count {
            color: rgba(255,255,255,0.8);
        }
        
        /* Table */
        .table-wrapper {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }
        
        thead {
            background: var(--bg);
        }
        
        th {
            padding: 0.75rem 0.875rem;
            text-align: left;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-2);
            text-transform: uppercase;
            letter-spacing: 0.3px;
            border-bottom: 2px solid var(--border);
            white-space: nowrap;
        }
        
        tbody tr {
            border-bottom: 1px solid var(--border);
            transition: background 0.1s;
            cursor: pointer;
        }
        
        tbody tr:not(.detail-row):hover {
            background: var(--bg);
        }
        
        tbody tr.red {
            background: linear-gradient(to right, var(--red-bg) 0%, var(--card) 6%);
        }
        
        tbody tr.yellow {
            background: linear-gradient(to right, var(--yellow-bg) 0%, var(--card) 6%);
        }
        
        tbody tr.red:hover {
            background: linear-gradient(to right, #fee2e2 0%, var(--bg) 6%);
        }
        
        tbody tr.yellow:hover {
            background: linear-gradient(to right, #fef3c7 0%, var(--bg) 6%);
        }
        
        td {
            padding: 0.75rem 0.875rem;
            white-space: nowrap;
        }
        
        /* Expand button */
        .expand-cell {
            width: 30px;
            text-align: center;
        }
        
        .expand-btn {
            color: var(--text-3);
            font-size: 0.9rem;
            transition: all 0.2s;
            user-select: none;
            display: inline-block;
            width: 20px;
            height: 20px;
            line-height: 20px;
            text-align: center;
        }
        
        .expand-btn:hover {
            color: var(--blue);
            transform: scale(1.2);
        }
        
        .expand-btn.expanded {
            transform: rotate(90deg);
            color: var(--blue);
        }
        
        /* Light indicator */
        .light {
            font-size: 1.3rem;
            width: 40px;
            text-align: center;
        }
        
        /* Order info */
        .order-date {
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-2);
            font-size: 0.8rem;
        }
        
        .order-no {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            color: var(--blue);
        }
        
        .customer {
            font-weight: 500;
            max-width: 150px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* Stage info */
        .stage-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .stage-major {
            font-size: 0.7rem;
            color: var(--text-3);
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        .stage-current {
            font-weight: 600;
            color: var(--text);
        }
        
        /* Days indicator */
        .days {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .days.warning { color: var(--yellow); }
        .days.danger { color: var(--red); }
        
        /* Actions */
        .actions {
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        tbody tr:hover .actions {
            opacity: 1;
        }
        
        .action-btns {
            display: flex;
            gap: 0.375rem;
        }
        
        .btn {
            padding: 0.3rem 0.75rem;
            background: var(--blue);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .btn:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
        }
        
        .btn.secondary {
            background: transparent;
            color: var(--text-2);
            border: 1px solid var(--border);
        }
        
        .btn.secondary:hover {
            background: var(--bg);
            border-color: var(--blue);
            color: var(--blue);
        }
        
        /* Detail row */
        .detail-row {
            display: none;
            background: var(--bg);
        }
        
        .detail-row.show {
            display: table-row;
        }
        
        .detail-content {
            padding: 1.25rem 2rem 1.25rem 3rem;
            border-left: 3px solid var(--blue);
        }
        
        .timeline-title {
            font-size: 0.75rem;
            color: var(--text-3);
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Horizontal Timeline */
        .timeline-horizontal {
            display: flex;
            align-items: flex-start;
            gap: 0;
            overflow-x: auto;
            padding: 0.5rem 0;
        }
        
        .timeline-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            min-width: 140px;
            position: relative;
            flex-shrink: 0;
        }
        
        .timeline-step:not(:last-child)::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 20px;
            width: 140px;
            height: 2px;
            background: var(--border);
            z-index: 0;
        }
        
        .timeline-step.completed:not(:last-child)::after {
            background: var(--green);
        }
        
        .timeline-dot-wrap {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--card);
            border: 2px solid var(--border);
            position: relative;
            z-index: 1;
        }
        
        .timeline-step.completed .timeline-dot-wrap {
            background: var(--green-bg);
            border-color: var(--green);
        }
        
        .timeline-step.current .timeline-dot-wrap {
            background: var(--blue);
            border-color: var(--blue);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.4);
            }
            50% { 
                transform: scale(1.05); 
                box-shadow: 0 0 0 8px rgba(37, 99, 235, 0);
            }
        }
        
        .timeline-dot {
            font-size: 1.2rem;
        }
        
        .timeline-step.completed .timeline-dot {
            color: var(--green);
        }
        
        .timeline-step.current .timeline-dot {
            color: white;
        }
        
        .timeline-step-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
        }
        
        .timeline-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text);
            text-align: center;
            line-height: 1.3;
        }
        
        .timeline-meta {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.125rem;
        }
        
        .timeline-date {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--text-3);
        }
        
        .timeline-duration {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--text);
            background: var(--bg);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }
        
        .timeline-step.current .timeline-duration {
            color: var(--blue);
            background: rgba(37, 99, 235, 0.1);
        }
        
        .timeline-step.warning .timeline-duration {
            color: var(--yellow);
            background: var(--yellow-bg);
        }
        
        .timeline-step.danger .timeline-duration {
            color: var(--red);
            background: var(--red-bg);
        }
        
        .revision-tag {
            font-size: 0.65rem;
            background: var(--yellow-bg);
            color: var(--yellow);
            padding: 0.125rem 0.375rem;
            border-radius: 3px;
            font-weight: 600;
        }
        
        /* Summary bar */
        .timeline-summary {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 1rem;
            padding: 0.75rem 1rem;
            background: var(--card);
            border-radius: 6px;
            border: 1px solid var(--border);
        }
        
        .summary-item {
            display: flex;
            flex-direction: column;
            gap: 0.125rem;
        }
        
        .summary-label {
            font-size: 0.7rem;
            color: var(--text-3);
        }
        
        .summary-value {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .summary-item.danger .summary-value {
            color: var(--red);
        }
        
        .summary-item.success .summary-value {
            color: var(--green);
        }
        
        /* Summary expandable */
        .timeline-summary {
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .timeline-summary:hover {
            border-color: var(--blue);
            background: var(--bg);
        }
        
        .timeline-summary.collapsed .summary-expand {
            transform: rotate(0deg);
        }
        
        .timeline-summary.expanded .summary-expand {
            transform: rotate(180deg);
        }
        
        .summary-expand {
            transition: transform 0.2s;
            color: var(--text-3);
        }
        
        .summary-details {
            display: none;
            margin-top: 1rem;
            padding: 1rem;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 6px;
        }
        
        .summary-details.show {
            display: block;
        }
        
        .detail-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            margin-bottom: 1rem;
        }
        
        .detail-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .detail-item-label {
            font-size: 0.7rem;
            color: var(--text-3);
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }
        
        .detail-item-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .detail-item-value.editable {
            color: var(--blue);
            cursor: pointer;
            text-decoration: underline dashed;
        }
        
        .notes-history {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }
        
        .notes-history-title {
            font-size: 0.7rem;
            color: var(--text-3);
            text-transform: uppercase;
            letter-spacing: 0.3px;
            margin-bottom: 0.75rem;
        }
        
        .note-item {
            display: flex;
            gap: 0.75rem;
            padding: 0.5rem;
            margin-bottom: 0.5rem;
            background: var(--bg);
            border-radius: 4px;
        }
        
        .note-date {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.7rem;
            color: var(--text-3);
            min-width: 60px;
        }
        
        .note-text {
            font-size: 0.8rem;
            color: var(--text);
        }
        
        /* Note icon and tooltip */
        .note-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--bg);
            color: var(--text-3);
            font-size: 0.7rem;
            cursor: help;
            margin-left: 0.25rem;
            position: relative;
        }
        
        .note-icon:hover {
            background: var(--blue);
            color: white;
        }
        
        .note-tooltip {
            display: none;
            position: absolute;
            bottom: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%);
            background: var(--text);
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            white-space: nowrap;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .note-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: var(--text);
        }
        
        .note-icon:hover .note-tooltip {
            display: block;
        }
        
        /* Modal styles */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            backdrop-filter: blur(4px);
        }
        
        .modal-overlay.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal {
            background: var(--card);
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 90%;
            animation: modalSlideIn 0.3s ease-out;
        }
        
        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-header {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }
        
        .modal-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text);
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .modal-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem;
            background: var(--bg);
            border-radius: 6px;
            margin-bottom: 1.25rem;
            font-size: 0.85rem;
        }
        
        .modal-info-text {
            color: var(--text-2);
        }
        
        .modal-arrow {
            color: var(--text-3);
            font-weight: 600;
        }
        
        .modal-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-2);
            margin-bottom: 0.5rem;
        }
        
        .modal-textarea {
            width: 100%;
            min-height: 80px;
            padding: 0.75rem;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.85rem;
            resize: vertical;
            transition: border-color 0.2s;
        }
        
        .modal-textarea:focus {
            outline: none;
            border-color: var(--blue);
        }
        
        .modal-hint {
            font-size: 0.7rem;
            color: var(--text-3);
            margin-top: 0.5rem;
        }
        
        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
        }
        
        .modal-btn {
            padding: 0.5rem 1.25rem;
            border: none;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .modal-btn.cancel {
            background: transparent;
            color: var(--text-2);
            border: 1px solid var(--border);
        }
        
        .modal-btn.cancel:hover {
            background: var(--bg);
        }
        
        .modal-btn.confirm {
            background: var(--blue);
            color: white;
        }
        
        .modal-btn.confirm:hover {
            background: #1d4ed8;
        }
        
        .modal-btn.danger {
            background: var(--red);
        }
        
        .modal-btn.danger:hover {
            background: #b91c1c;
        }
        
        /* Menu modal */
        .menu-option {
            padding: 0.875rem 1rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 6px;
            margin-bottom: 0.5rem;
        }
        
        .menu-option:hover {
            background: var(--bg);
        }
        
        .menu-option.danger:hover {
            background: var(--red-bg);
            color: var(--red);
        }
        
        .menu-icon {
            font-size: 1.2rem;
        }
        
        .menu-text {
            flex: 1;
        }
        
        .menu-label {
            font-weight: 500;
            font-size: 0.85rem;
        }
        
        .menu-desc {
            font-size: 0.7rem;
            color: var(--text-3);
            margin-top: 0.125rem;
        }
        
        /* Filter checkbox */
        .filter-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 6px;
            user-select: none;
            border: 2px solid transparent;
        }
        
        .filter-checkbox:hover {
            background: var(--bg);
            border-color: var(--border);
        }
        
        .filter-checkbox input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--blue);
        }
        
        .filter-checkbox span {
            color: var(--text-2);
            font-weight: 400;
        }
        
        .filter-checkbox:has(input:checked) {
            background: rgba(37, 99, 235, 0.05);
        }
        
        .filter-checkbox:has(input:checked) span {
            color: var(--blue);
            font-weight: 600;
        }
        
        /* Back step options */
        .back-step-option {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.875rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .back-step-option:hover {
            border-color: var(--blue);
            background: var(--bg);
        }
        
        .back-step-option:has(input:checked) {
            border-color: var(--blue);
            background: rgba(37, 99, 235, 0.05);
        }
        
        .back-step-option input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--blue);
        }
        
        .back-step-info {
            flex: 1;
        }
        
        .back-step-name {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text);
        }
        
        .back-step-desc {
            font-size: 0.75rem;
            color: var(--text-3);
            margin-top: 0.125rem;
        }
        
        /* Timeline step with actions */
        .timeline-step {
            position: relative;
        }
        
        .timeline-step-actions {
            position: absolute;
            right: -30px;
            top: 10px;
            opacity: 0;
            transition: opacity 0.2s;
        }
        
        .timeline-step:hover .timeline-step-actions {
            opacity: 1;
        }
        
        .step-menu-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--card);
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--text-3);
            transition: all 0.2s;
        }
        
        .step-menu-btn:hover {
            background: var(--blue);
            color: white;
            border-color: var(--blue);
        }
        
        .step-action-menu {
            display: none;
            position: absolute;
            right: 30px;
            top: 0;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            padding: 0.5rem;
            min-width: 180px;
            z-index: 100;
        }
        
        .step-action-menu.show {
            display: block;
        }
        
        .step-action-option {
            padding: 0.5rem 0.75rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
        }
        
        .step-action-option:hover {
            background: var(--bg);
        }
        
        .step-action-option.danger:hover {
            background: var(--red-bg);
            color: var(--red);
        }
        
        /* Quick jump section */
        .quick-jump-section {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 2px dashed var(--border);
        }
        
        .quick-jump-title {
            font-size: 0.75rem;
            color: var(--text-3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.75rem;
            font-weight: 600;
        }
        
        .quick-jump-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .quick-jump-btn {
            padding: 0.75rem 1rem;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .quick-jump-btn:hover {
            border-color: var(--blue);
            background: var(--bg);
        }
        
        .quick-jump-label {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text);
        }
        
        .quick-jump-desc {
            font-size: 0.75rem;
            color: var(--text-3);
            margin-top: 0.125rem;
        }
        
        .quick-jump-icon {
            font-size: 1.2rem;
        }
        
        /* Compact Timeline (horizontal) */
        .timeline-compact {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            background: var(--bg);
            border-radius: 8px;
            margin-bottom: 1rem;
            overflow-x: auto;
        }
        
        .timeline-compact-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
            min-width: 60px;
        }
        
        .timeline-compact-icon {
            font-size: 1.5rem;
        }
        
        .timeline-compact-name {
            font-size: 0.7rem;
            color: var(--text-2);
            text-align: center;
            line-height: 1.2;
        }
        
        .timeline-compact-duration {
            font-size: 0.65rem;
            color: var(--text-3);
            font-family: 'JetBrains Mono', monospace;
        }
        
        .timeline-compact-step.current .timeline-compact-duration {
            color: var(--red);
            font-weight: 700;
        }
        
        .timeline-compact-arrow {
            color: var(--border);
            font-size: 1.2rem;
        }
        
        /* Timeline Summary Bar */
        .timeline-summary-bar {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            padding: 1rem;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .timeline-summary-bar .summary-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }
        
        .timeline-summary-bar .summary-label {
            font-size: 0.7rem;
            color: var(--text-3);
        }
        
        .timeline-summary-bar .summary-value {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text);
        }
        
        .timeline-summary-bar .summary-value.danger {
            color: var(--red);
        }
        
        /* Toggle Button */
        .timeline-toggle-btn {
            width: 100%;
            padding: 0.75rem;
            background: var(--bg);
            border: 2px dashed var(--border);
            border-radius: 6px;
            color: var(--blue);
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        .timeline-toggle-btn:hover {
            background: rgba(37, 99, 235, 0.05);
            border-color: var(--blue);
        }
        
        /* Detailed Timeline (cards) */
        .timeline-detailed {
            display: none;
            margin-top: 1rem;
        }
        
        .timeline-detailed.show {
            display: block;
        }
        
        .step-card {
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            transition: all 0.2s;
            position: relative;
        }
        
        .step-card:hover {
            border-color: var(--blue);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .step-card.current {
            border-color: var(--blue);
            background: rgba(37, 99, 235, 0.03);
        }
        
        .step-card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }
        
        .step-card-icon {
            font-size: 1.3rem;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: var(--bg);
        }
        
        .step-card.current .step-card-icon {
            background: var(--blue);
            color: white;
        }
        
        .step-card-name {
            flex: 1;
            font-weight: 600;
            font-size: 0.95rem;
            color: var(--text);
        }
        
        .step-card-date {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.75rem;
            color: var(--text-3);
        }
        
        .step-card-body {
            margin-left: 44px;
        }
        
        .step-card-duration {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            color: var(--text-2);
            margin-bottom: 0.5rem;
        }
        
        .step-card.current .step-card-duration {
            color: var(--red);
            font-weight: 700;
        }
        
        .step-card-note {
            font-size: 0.85rem;
            color: var(--text-2);
            background: var(--bg);
            padding: 0.5rem 0.75rem;
            border-radius: 4px;
            border-left: 3px solid var(--blue);
        }
        
        .step-card-menu-btn {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--bg);
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--text-3);
            transition: all 0.2s;
            position: relative;
        }
        
        .step-card-menu-btn:hover {
            background: var(--blue);
            color: white;
            border-color: var(--blue);
        }
        
        /* Responsive */
        @media (max-width: 1400px) {
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <div class="title">üì¶ Ë®ÇÂñÆÊµÅÁ®ãËøΩËπ§Á≥ªÁµ±</div>
            
            <div class="search-box">
                <span>üîç</span>
                <input type="text" placeholder="ÊêúÂ∞ãË®ÇÂñÆËôü„ÄÅÂÆ¢Êà∂ÂêçÁ®±...">
            </div>
        </div>
    </div>
    
    <div class="container">
        <!-- Stats -->
        <div class="stats">
            <div class="stat">
                <div class="stat-icon">üì¶</div>
                <div>
                    <div class="stat-label">ÈÄ≤Ë°å‰∏≠</div>
                    <div class="stat-value">42</div>
                </div>
            </div>
            
            <div class="stat red">
                <div class="stat-icon">üî¥</div>
                <div>
                    <div class="stat-label">ÈÄæÊúü</div>
                    <div class="stat-value">5</div>
                </div>
            </div>
            
            <div class="stat yellow">
                <div class="stat-icon">üü°</div>
                <div>
                    <div class="stat-label">ÈúÄÊ≥®ÊÑè</div>
                    <div class="stat-value">12</div>
                </div>
            </div>
            
            <div class="stat green">
                <div class="stat-icon">‚úÖ</div>
                <div>
                    <div class="stat-label">Êú¨ÊúàÂÆåÊàê</div>
                    <div class="stat-value">38</div>
                </div>
            </div>
        </div>
        
        <!-- Stage Filters -->
        <div class="stage-filters">
            <button class="stage-btn active">
                üìã ÂÖ®ÈÉ®
                <span class="stage-count">42</span>
            </button>
            
            <div class="stage-filter">
                <button class="stage-btn" onclick="toggleSubstatus('draft')">
                    üìÑ ÂúñÁ®øÈöéÊÆµ
                    <span class="stage-count">15</span>
                    <span style="font-size: 0.7rem;">‚ñº</span>
                </button>
                <div class="substatus-dropdown" id="dropdown-draft">
                    <div class="substatus-label">ÂúñÁ®øÂ∞èÁãÄÊÖã</div>
                    <div class="substatus-option active">
                        <span>ÂÖ®ÈÉ®</span>
                        <span class="count">15</span>
                    </div>
                    <div class="substatus-option">
                        <span>Êñ∞Ë®ÇÂñÆ</span>
                        <span class="count">3</span>
                    </div>
                    <div class="substatus-option">
                        <span>ÂúñÁ®øË£Ω‰Ωú‰∏≠</span>
                        <span class="count">5</span>
                    </div>
                    <div class="substatus-option">
                        <span>ÂúñÁ®øÂæÖÁ¢∫Ë™ç</span>
                        <span class="count">4</span>
                    </div>
                    <div class="substatus-option">
                        <span>ÂúñÁ®ø‰øÆÊîπ‰∏≠</span>
                        <span class="count">3</span>
                    </div>
                </div>
            </div>
            
            <div class="stage-filter">
                <button class="stage-btn" onclick="toggleSubstatus('sampling')">
                    üß™ ÊâìÊ®£ÈöéÊÆµ
                    <span class="stage-count">12</span>
                    <span style="font-size: 0.7rem;">‚ñº</span>
                </button>
                <div class="substatus-dropdown" id="dropdown-sampling">
                    <div class="substatus-label">ÊâìÊ®£Â∞èÁãÄÊÖã</div>
                    <div class="substatus-option active">
                        <span>ÂÖ®ÈÉ®</span>
                        <span class="count">12</span>
                    </div>
                    <div class="substatus-option">
                        <span>Ê∫ñÂÇôÊâìÊ®£</span>
                        <span class="count">2</span>
                    </div>
                    <div class="substatus-option">
                        <span>ÊâìÊ®£Ë£Ω‰Ωú‰∏≠</span>
                        <span class="count">4</span>
                    </div>
                    <div class="substatus-option">
                        <span>Ê®£ÂìÅÂæÖÁ¢∫Ë™ç</span>
                        <span class="count">5</span>
                    </div>
                    <div class="substatus-option">
                        <span>Ê®£ÂìÅ‰øÆÊîπ‰∏≠</span>
                        <span class="count">1</span>
                    </div>
                </div>
            </div>
            
            <div class="stage-filter">
                <button class="stage-btn" onclick="toggleSubstatus('production')">
                    üè≠ ÁîüÁî¢ÈöéÊÆµ
                    <span class="stage-count">8</span>
                    <span style="font-size: 0.7rem;">‚ñº</span>
                </button>
                <div class="substatus-dropdown" id="dropdown-production">
                    <div class="substatus-label">ÁîüÁî¢Â∞èÁãÄÊÖã</div>
                    <div class="substatus-option active">
                        <span>ÂÖ®ÈÉ®</span>
                        <span class="count">8</span>
                    </div>
                    <div class="substatus-option">
                        <span>Ê∫ñÂÇôÁîüÁî¢</span>
                        <span class="count">3</span>
                    </div>
                    <div class="substatus-option">
                        <span>ÁîüÁî¢‰∏≠</span>
                        <span class="count">5</span>
                    </div>
                </div>
            </div>
            
            <button class="stage-btn pending">
                ‚è≥ Á≠âÂúãÂ§ñÁ¢∫Ë™ç
                <span class="stage-count">9</span>
            </button>
            
            <!-- Divider -->
            <div style="width: 1px; height: 30px; background: var(--border); margin: 0 0.5rem;"></div>
            
            <!-- Checkboxes for completed/cancelled -->
            <label class="filter-checkbox">
                <input type="checkbox" id="toggleCompleted" checked onchange="toggleCompletedOrders(this)">
                <span>È°ØÁ§∫Â∑≤ÂÆåÊàê (38)</span>
            </label>
            
            <label class="filter-checkbox">
                <input type="checkbox" id="toggleCancelled" onchange="toggleCancelledOrders(this)">
                <span>È°ØÁ§∫Â∑≤ÂèñÊ∂à (7)</span>
            </label>
        </div>
        
        <!-- Table -->
        <div class="table-wrapper">
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th></th>
                            <th></th>
                            <th>Ë®ÇÂñÆÊó•Êúü</th>
                            <th>Ë®ÇÂñÆËôü</th>
                            <th>ÂÆ¢Êà∂ÂêçÁ®±</th>
                            <th>Áî¢ÂìÅÁ∑®Ëôü</th>
                            <th>Êï∏Èáè</th>
                            <th>ÁîüÁî¢Â∑•Âª†</th>
                            <th>ÈöéÊÆµ/ÁãÄÊÖã</th>
                            <th>Á≠âÂæÖÂ§©Êï∏</th>
                            <th>Áî¢ÂìÅÈ°ûÂûã</th>
                            <th>ÂÇôË®ª</th>
                            <th>Êìç‰Ωú</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Row 1: Ê®£ÂìÅÂæÖÁ¢∫Ë™ç - ÈÄæÊúü -->
                        <tr class="red" onclick="toggleDetail(1, event)">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-1">‚ñ∂</span>
                            </td>
                            <td class="light">üî¥</td>
                            <td class="order-date">2025/12/05</td>
                            <td class="order-no">#1007273</td>
                            <td class="customer">SERGIO CONDE COLOUR</td>
                            <td>PRD-2025-001</td>
                            <td>500 Á¢º</td>
                            <td>Âª£Â∑ûÂ∑•Âª†</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">üß™ ÊâìÊ®£ÈöéÊÆµ</div>
                                    <div class="stage-current">Ê®£ÂìÅÂæÖÁ¢∫Ë™ç</div>
                                </div>
                            </td>
                            <td><span class="days danger">15Â§©</span></td>
                            <td>ÂÜ∞Áµ≤Á¢∫Ââ™Á¢ºÂç∞Ëä±</td>
                            <td class="notes">Á≠âÂúãÂ§ñÁ¢∫Ë™çÊ®£ÂìÅ</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn" onclick="showActionModal('confirm', 'Ê®£ÂìÅÂæÖÁ¢∫Ë™ç', 'Ê∫ñÂÇôÁîüÁî¢', '#1007273')">‚úì ÂúãÂ§ñÁ¢∫Ë™ç</button>
                                    <button class="btn secondary" style="background: var(--yellow); color: white; border: none;" onclick="showActionModal('revise', 'Ê®£ÂìÅÂæÖÁ¢∫Ë™ç', 'ÊâìÊ®£Ë£Ω‰Ωú‰∏≠', '#1007273')">üîÑ ÈúÄË¶ÅÈáçÊâì</button>
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007273')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-1">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤</div>
                                    
                                    <!-- Beautiful Horizontal Timeline (Original Style) -->
                                    <div class="timeline-horizontal" id="timeline-visual-1">
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚úì</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Êñ∞Ë®ÇÂñÆ</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-date">12/05</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚úì</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÂúñÁ®øË£Ω‰Ωú</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-duration">Ëä±‰∫Ü 3Â§©</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚úì</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÂúñÁ®øÁ¢∫Ë™ç</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-date">12/08 ÁôºÂúñ</div>
                                                    <div class="timeline-duration">Ëä±‰∫Ü 2Â§©</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚úì</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Ê∫ñÂÇôÊâìÊ®£</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-duration">Ëä±‰∫Ü 1Â§©</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚úì</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÊâìÊ®£Ë£Ω‰Ωú</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-duration">Ëä±‰∫Ü 4Â§©</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step current danger">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚è±Ô∏è</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Ê®£ÂìÅÁ¢∫Ë™ç</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-date">12/15 ÈÄÅÊ®£</div>
                                                    <div class="timeline-duration">Â∑≤Á≠â 15Â§© ‚ö†Ô∏è</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Summary Bar -->
                                    <div class="timeline-summary-bar">
                                        <div class="summary-item">
                                            <div class="summary-label">Ë®ÇÂñÆÂâµÂª∫</div>
                                            <div class="summary-value">2025/12/05</div>
                                        </div>
                                        <div class="summary-item">
                                            <div class="summary-label">Á∏ΩËÄóÊôÇ</div>
                                            <div class="summary-value danger">25Â§©ÔºàÈÄæÊúüÔºâ</div>
                                        </div>
                                        <div class="summary-item">
                                            <div class="summary-label">Áï∂ÂâçÁãÄÊÖã</div>
                                            <div class="summary-value">Ê®£ÂìÅÂæÖÁ¢∫Ë™ç</div>
                                        </div>
                                        <div class="summary-item">
                                            <div class="summary-label">Á≠âÂæÖÊôÇÈñì</div>
                                            <div class="summary-value danger">15Â§©</div>
                                        </div>
                                    </div>
                                    
                                    <!-- Toggle Detailed Button -->
                                    <button class="timeline-toggle-btn" id="toggle-btn-1" onclick="toggleDetailedTimeline(1)">
                                        üìã Êü•ÁúãË©≥Á¥∞Ë®òÈåÑ
                                    </button>
                                    
                                    <!-- Detailed Timeline List (Compact) -->
                                    <div class="timeline-detailed" id="timeline-detailed-1">
                                        <table style="width: 100%; border-collapse: collapse;">
                                            <tbody>
                                                <tr style="border-bottom: 1px solid var(--border);">
                                                    <td style="padding: 0.75rem; width: 40px;">‚úì</td>
                                                    <td style="padding: 0.75rem; font-weight: 600;">Êñ∞Ë®ÇÂñÆ</td>
                                                    <td style="padding: 0.75rem; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--text-3);">2025/12/05 10:00</td>
                                                    <td style="padding: 0.75rem;"></td>
                                                    <td style="padding: 0.75rem; width: 40px; text-align: right;">
                                                        <div class="step-card-menu-btn" onclick="toggleStepMenu(event, '1-1')">‚ãÆ
                                                            <div class="step-action-menu" id="step-menu-1-1">
                                                                <div class="step-action-option" onclick="editStepNote('Êñ∞Ë®ÇÂñÆ', '1007273', 1)">üìù Á∑®ËºØÂÇôË®ª</div>
                                                                <div class="step-action-option" onclick="backToStep('Êñ∞Ë®ÇÂñÆ', '1007273', 1)">‚Ü©Ô∏è ÈÄÄÂõûÂà∞ÈÄôË£°</div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr style="border-bottom: 1px solid var(--border);">
                                                    <td style="padding: 0.75rem;">‚úì</td>
                                                    <td style="padding: 0.75rem; font-weight: 600;">ÂúñÁ®øË£Ω‰Ωú‰∏≠</td>
                                                    <td style="padding: 0.75rem; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--text-3);">2025/12/05 14:00</td>
                                                    <td style="padding: 0.75rem; font-size: 0.8rem; color: var(--text-2);">‚è±Ô∏è Ëä±‰∫Ü 3Â§© <span style="background: var(--bg); padding: 0.25rem 0.5rem; border-radius: 4px; margin-left: 0.5rem;">üìù ‰∏≠ÂúãÂÅöÂúñ</span></td>
                                                    <td style="padding: 0.75rem; text-align: right;">
                                                        <div class="step-card-menu-btn" onclick="toggleStepMenu(event, '1-2')">‚ãÆ
                                                            <div class="step-action-menu" id="step-menu-1-2">
                                                                <div class="step-action-option" onclick="editStepNote('ÂúñÁ®øË£Ω‰Ωú‰∏≠', '1007273', 2)">üìù Á∑®ËºØÂÇôË®ª</div>
                                                                <div class="step-action-option" onclick="backToStep('ÂúñÁ®øË£Ω‰Ωú‰∏≠', '1007273', 2)">‚Ü©Ô∏è ÈÄÄÂõûÂà∞ÈÄôË£°</div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr style="border-bottom: 1px solid var(--border);">
                                                    <td style="padding: 0.75rem;">‚úì</td>
                                                    <td style="padding: 0.75rem; font-weight: 600;">ÂúñÁ®øÂæÖÁ¢∫Ë™ç</td>
                                                    <td style="padding: 0.75rem; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--text-3);">2025/12/08 09:00</td>
                                                    <td style="padding: 0.75rem; font-size: 0.8rem; color: var(--text-2);">‚è±Ô∏è Ëä±‰∫Ü 2Â§© <span style="background: var(--bg); padding: 0.25rem 0.5rem; border-radius: 4px; margin-left: 0.5rem;">üìù Â∑≤ÁôºÂúñÁµ¶SERGIOÂÖàÁîü</span></td>
                                                    <td style="padding: 0.75rem; text-align: right;">
                                                        <div class="step-card-menu-btn" onclick="toggleStepMenu(event, '1-3')">‚ãÆ
                                                            <div class="step-action-menu" id="step-menu-1-3">
                                                                <div class="step-action-option" onclick="editStepNote('ÂúñÁ®øÂæÖÁ¢∫Ë™ç', '1007273', 3)">üìù Á∑®ËºØÂÇôË®ª</div>
                                                                <div class="step-action-option" onclick="backToStep('ÂúñÁ®øÂæÖÁ¢∫Ë™ç', '1007273', 3)">‚Ü©Ô∏è ÈÄÄÂõûÂà∞ÈÄôË£°</div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr style="border-bottom: 1px solid var(--border);">
                                                    <td style="padding: 0.75rem;">‚úì</td>
                                                    <td style="padding: 0.75rem; font-weight: 600;">Ê∫ñÂÇôÊâìÊ®£</td>
                                                    <td style="padding: 0.75rem; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--text-3);">2025/12/10 16:00</td>
                                                    <td style="padding: 0.75rem; font-size: 0.8rem; color: var(--text-2);">‚è±Ô∏è Ëä±‰∫Ü 1Â§©</td>
                                                    <td style="padding: 0.75rem; text-align: right;">
                                                        <div class="step-card-menu-btn" onclick="toggleStepMenu(event, '1-4')">‚ãÆ
                                                            <div class="step-action-menu" id="step-menu-1-4">
                                                                <div class="step-action-option" onclick="editStepNote('Ê∫ñÂÇôÊâìÊ®£', '1007273', 4)">üìù Á∑®ËºØÂÇôË®ª</div>
                                                                <div class="step-action-option" onclick="backToStep('Ê∫ñÂÇôÊâìÊ®£', '1007273', 4)">‚Ü©Ô∏è ÈÄÄÂõûÂà∞ÈÄôË£°</div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr style="border-bottom: 1px solid var(--border);">
                                                    <td style="padding: 0.75rem;">‚úì</td>
                                                    <td style="padding: 0.75rem; font-weight: 600;">ÊâìÊ®£Ë£Ω‰Ωú‰∏≠</td>
                                                    <td style="padding: 0.75rem; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--text-3);">2025/12/11 10:00</td>
                                                    <td style="padding: 0.75rem; font-size: 0.8rem; color: var(--text-2);">‚è±Ô∏è Ëä±‰∫Ü 4Â§©</td>
                                                    <td style="padding: 0.75rem; text-align: right;">
                                                        <div class="step-card-menu-btn" onclick="toggleStepMenu(event, '1-5')">‚ãÆ
                                                            <div class="step-action-menu" id="step-menu-1-5">
                                                                <div class="step-action-option" onclick="editStepNote('ÊâìÊ®£Ë£Ω‰Ωú‰∏≠', '1007273', 5)">üìù Á∑®ËºØÂÇôË®ª</div>
                                                                <div class="step-action-option" onclick="backToStep('ÊâìÊ®£Ë£Ω‰Ωú‰∏≠', '1007273', 5)">‚Ü©Ô∏è ÈÄÄÂõûÂà∞ÈÄôË£°</div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <tr style="background: rgba(37, 99, 235, 0.03);">
                                                    <td style="padding: 0.75rem;">‚è±Ô∏è</td>
                                                    <td style="padding: 0.75rem; font-weight: 600; color: var(--blue);">Ê®£ÂìÅÂæÖÁ¢∫Ë™ç</td>
                                                    <td style="padding: 0.75rem; font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--text-3);">2025/12/15 08:00</td>
                                                    <td style="padding: 0.75rem; font-size: 0.8rem; font-weight: 700; color: var(--red);">‚è±Ô∏è Â∑≤Á≠â 15Â§© üî¥ <span style="background: var(--bg); padding: 0.25rem 0.5rem; border-radius: 4px; margin-left: 0.5rem; font-weight: 400; color: var(--text-2);">üìù Á≠âÂúãÂ§ñÁ¢∫Ë™çÊ®£ÂìÅ</span></td>
                                                    <td style="padding: 0.75rem; text-align: right;">
                                                        <div class="step-card-menu-btn" onclick="toggleStepMenu(event, '1-6')">‚ãÆ
                                                            <div class="step-action-menu" id="step-menu-1-6">
                                                                <div class="step-action-option" onclick="editStepNote('Ê®£ÂìÅÂæÖÁ¢∫Ë™ç', '1007273', 6)">üìù Á∑®ËºØÂÇôË®ª</div>
                                                                <div class="step-action-option danger" onclick="undoLastStep('#1007273', 1, 6)">üóëÔ∏è Êí§Èä∑Ê≠§Ê≠•È©ü</div>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Row 2: ÂúñÁ®ø‰øÆÊîπ‰∏≠ - ÊúâÈáçÂÅöÁóïË∑° -->
                        <tr class="yellow" onclick="toggleDetail(2, event)">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-2">‚ñ∂</span>
                            </td>
                            <td class="light">üü°</td>
                            <td class="order-date">2025/12/18</td>
                            <td class="order-no">#1007280</td>
                            <td class="customer">VICENTA MOLLE FLORES</td>
                            <td>PRD-2025-002</td>
                            <td>300 Á¢º</td>
                            <td>Ê∑±Âú≥Â∑•Âª†</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">üìÑ ÂúñÁ®øÈöéÊÆµ</div>
                                    <div class="stage-current">ÂúñÁ®ø‰øÆÊîπ‰∏≠</div>
                                </div>
                            </td>
                            <td><span class="days warning">5Â§©</span></td>
                            <td>ÂÜ∞Áµ≤Á¢∫Ââ™Á¢ºÂç∞Ëä±</td>
                            <td class="notes">ÈúÄË¶ÅÊîπÂúñ</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn" onclick="showActionModal('send', 'ÂúñÁ®ø‰øÆÊîπ‰∏≠', 'ÂúñÁ®øÂæÖÁ¢∫Ë™ç', '#1007280')">‚Üí ÈáçÊñ∞ÁôºÂúñÁµ¶ÂúãÂ§ñ</button>
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007280')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-2">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤ - Âê´ÈáçÂÅöË®òÈåÑ</div>
                                    
                                    <div class="timeline-horizontal">
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚úì</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Êñ∞Ë®ÇÂñÆ</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-date">12/18</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚úì</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÂúñÁ®øË£Ω‰Ωú<br><span class="revision-tag">Á¨¨1Áâà</span></div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-duration">Ëä±‰∫Ü 2Â§©</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚úì</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÂúñÁ®øÁ¢∫Ë™ç<br><span class="revision-tag">Á¨¨1Áâà</span></div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-date">12/20 ÁôºÂúñ</div>
                                                    <div class="timeline-duration">Ëä±‰∫Ü 3Â§©</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step current warning">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">üîÑ</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÂúñÁ®ø‰øÆÊîπ<br><span class="revision-tag">ÊîπÁ¨¨2Áâà</span></div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-date">12/23 ÂÆ¢Êà∂ÂèçÈ•ã</div>
                                                    <div class="timeline-duration">Â∑≤Áî® 5Â§© ‚ö†Ô∏è</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚óã</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÂúñÁ®øÁ¢∫Ë™ç<br><span class="revision-tag">Á¨¨2Áâà</span></div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚óã</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Ê∫ñÂÇôÊâìÊ®£</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="timeline-summary">
                                        <div class="summary-item">
                                            <div class="summary-label">Ë®ÇÂñÆÂâµÂª∫</div>
                                            <div class="summary-value">2025/12/18</div>
                                        </div>
                                        <div class="summary-item">
                                            <div class="summary-label">Á∏ΩËÄóÊôÇ</div>
                                            <div class="summary-value">10Â§©</div>
                                        </div>
                                        <div class="summary-item">
                                            <div class="summary-label">‰øÆÊîπÊ¨°Êï∏</div>
                                            <div class="summary-value">1Ê¨°ÔºàÈ°èËâ≤Ë™øÊï¥Ôºâ</div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Row 3: ÂúñÁ®øÂæÖÁ¢∫Ë™ç - Á≠âÂúãÂ§ñ -->
                        <tr onclick="toggleDetail(3, event)">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-3">‚ñ∂</span>
                            </td>
                            <td class="light">üü¢</td>
                            <td class="order-date">2026/01/02</td>
                            <td class="order-no">#1007295</td>
                            <td class="customer">DANIEL CADENA</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">üìÑ ÂúñÁ®øÈöéÊÆµ</div>
                                    <div class="stage-current">ÂúñÁ®øÂæÖÁ¢∫Ë™ç</div>
                                </div>
                            </td>
                            <td><span class="days">3Â§©</span></td>
                            <td>Ê¥ªÊÄßÂç∞Ëä±</td>
                            <td class="notes">Á≠âÂÆ¢Êà∂Á¢∫Ë™ç</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn" onclick="showActionModal('confirm', 'ÂúñÁ®øÂæÖÁ¢∫Ë™ç', 'Ê∫ñÂÇôÊâìÊ®£', '#1007295')">‚úì ÂúãÂ§ñÁ¢∫Ë™ç</button>
                                    <button class="btn secondary" style="background: var(--yellow); color: white; border: none;" onclick="showActionModal('revise', 'ÂúñÁ®øÂæÖÁ¢∫Ë™ç', 'ÂúñÁ®ø‰øÆÊîπ‰∏≠', '#1007295')">üîÑ ÈúÄË¶Å‰øÆÊîπ</button>
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007295')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-3">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤</div>
                                    
                                    <div class="timeline-horizontal">
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚úì</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Êñ∞Ë®ÇÂñÆ</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-date">01/02</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚úì</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÂúñÁ®øË£Ω‰Ωú</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-duration">Ëä±‰∫Ü 2Â§©</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step current">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚è±Ô∏è</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÂúñÁ®øÁ¢∫Ë™ç</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-date">01/04 ÁôºÂúñ</div>
                                                    <div class="timeline-duration">Â∑≤Á≠â 3Â§©</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚óã</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Ê∫ñÂÇôÊâìÊ®£</div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚óã</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÊâìÊ®£Ë£Ω‰Ωú</div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚óã</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Ê®£ÂìÅÁ¢∫Ë™ç</div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚óã</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Ê∫ñÂÇôÁîüÁî¢</div>
                                            </div>
                                        </div>
                                        
                                        <div class="timeline-step">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚óã</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÁîüÁî¢</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="timeline-summary">
                                        <div class="summary-item">
                                            <div class="summary-label">Ë®ÇÂñÆÂâµÂª∫</div>
                                            <div class="summary-value">2026/01/02</div>
                                        </div>
                                        <div class="summary-item success">
                                            <div class="summary-label">Á∏ΩËÄóÊôÇ</div>
                                            <div class="summary-value">5Â§©ÔºàÊ≠£Â∏∏Ôºâ</div>
                                        </div>
                                        <div class="summary-item">
                                            <div class="summary-label">Áï∂ÂâçÁãÄÊÖã</div>
                                            <div class="summary-value">Á≠âÂÆ¢Êà∂Á¢∫Ë™çÂúñÁ®ø</div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Row 4: Êñ∞Ë®ÇÂñÆ -->
                        <tr onclick="toggleDetail(4, event)">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-4">‚ñ∂</span>
                            </td>
                            <td class="light">üü¢</td>
                            <td class="order-date">2026/01/08</td>
                            <td class="order-no">#1007300</td>
                            <td class="customer">MARIA RODRIGUEZ</td>
                            <td>PRD-2026-001</td>
                            <td>1000 Á¢º</td>
                            <td>Âª£Â∑ûÂ∑•Âª†</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">üìÑ ÂúñÁ®øÈöéÊÆµ</div>
                                    <div class="stage-current">Êñ∞Ë®ÇÂñÆ</div>
                                </div>
                            </td>
                            <td><span class="days">0Â§©</span></td>
                            <td>Êï∏Á¢ºÂç∞Ëä±</td>
                            <td class="notes">ÂâõÊé•ÂñÆ</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn" onclick="showActionModal('start', 'Êñ∞Ë®ÇÂñÆ', 'ÂúñÁ®øË£Ω‰Ωú‰∏≠', '#1007300')">‚Üí ÈñãÂßãË£Ω‰Ωú</button>
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007300')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-4">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤</div>
                                    <div class="timeline-horizontal">
                                        <div class="timeline-step current">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚è±Ô∏è</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Êñ∞Ë®ÇÂñÆ</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-date">01/08</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="timeline-summary">
                                        <div class="summary-item">
                                            <div class="summary-label">Ë®ÇÂñÆÂâµÂª∫</div>
                                            <div class="summary-value">2026/01/08</div>
                                        </div>
                                        <div class="summary-item success">
                                            <div class="summary-label">ÁãÄÊÖã</div>
                                            <div class="summary-value">ÂâõÂâµÂª∫</div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Row 5: ÂúñÁ®øË£Ω‰Ωú‰∏≠ -->
                        <tr onclick="toggleDetail(5, event)">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-5">‚ñ∂</span>
                            </td>
                            <td class="light">üü¢</td>
                            <td class="order-date">2026/01/06</td>
                            <td class="order-no">#1007298</td>
                            <td class="customer">CARLOS MENDEZ</td>
                            <td>PRD-2025-123</td>
                            <td>450 Á¢º</td>
                            <td>Ê∑±Âú≥Â∑•Âª†</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">üìÑ ÂúñÁ®øÈöéÊÆµ</div>
                                    <div class="stage-current">ÂúñÁ®øË£Ω‰Ωú‰∏≠</div>
                                </div>
                            </td>
                            <td><span class="days">2Â§©</span></td>
                            <td>Ê¥ªÊÄßÂç∞Ëä±</td>
                            <td class="notes">‰∏≠ÂúãË£ΩÂúñ‰∏≠</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn" onclick="showActionModal('send', 'ÂúñÁ®øË£Ω‰Ωú‰∏≠', 'ÂúñÁ®øÂæÖÁ¢∫Ë™ç', '#1007298')">‚Üí ÁôºÂúñÁµ¶ÂúãÂ§ñ</button>
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007298')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-5">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤</div>
                                    <div class="timeline-horizontal">
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚úì</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Êñ∞Ë®ÇÂñÆ</div>
                                            </div>
                                        </div>
                                        <div class="timeline-step current">
                                            <div class="timeline-dot-wrap">
                                                <div class="timeline-dot">‚öôÔ∏è</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÂúñÁ®øË£Ω‰Ωú‰∏≠</div>
                                                <div class="timeline-meta">
                                                    <div class="timeline-duration">ÈÄ≤Ë°å 2Â§©</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="timeline-summary">
                                        <div class="summary-item">
                                            <div class="summary-label">Â∑≤ËÄóÊôÇ</div>
                                            <div class="summary-value">2Â§©</div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Row 6: Ê∫ñÂÇôÊâìÊ®£ -->
                        <tr onclick="toggleDetail(6, event)">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-6">‚ñ∂</span>
                            </td>
                            <td class="light">üü¢</td>
                            <td class="order-date">2026/01/03</td>
                            <td class="order-no">#1007296</td>
                            <td class="customer">JORGE SILVA</td>
                            <td>PRD-2025-456</td>
                            <td>600 Á¢º</td>
                            <td>Êù±ËéûÂ∑•Âª†</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">üß™ ÊâìÊ®£ÈöéÊÆµ</div>
                                    <div class="stage-current">Ê∫ñÂÇôÊâìÊ®£</div>
                                </div>
                            </td>
                            <td><span class="days">1Â§©</span></td>
                            <td>ÂÜ∞Áµ≤Âç∞Ëä±</td>
                            <td class="notes">ÂúñÁ®øÂ∑≤Á¢∫Ë™ç</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn" onclick="showActionModal('start', 'Ê∫ñÂÇôÊâìÊ®£', 'ÊâìÊ®£Ë£Ω‰Ωú‰∏≠', '#1007296')">‚Üí ÈñãÂßãÊâìÊ®£</button>
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007296')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-6">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤</div>
                                    <div class="timeline-horizontal">
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚úì</div></div>
                                            <div class="timeline-step-info"><div class="timeline-label">ÂúñÁ®øÈöéÊÆµ</div></div>
                                        </div>
                                        <div class="timeline-step current">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚è±Ô∏è</div></div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Ê∫ñÂÇôÊâìÊ®£</div>
                                                <div class="timeline-meta"><div class="timeline-duration">Á≠âÂæÖ 1Â§©</div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Row 7: ÊâìÊ®£Ë£Ω‰Ωú‰∏≠ -->
                        <tr onclick="toggleDetail(7, event)">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-7">‚ñ∂</span>
                            </td>
                            <td class="light">üü°</td>
                            <td class="order-date">2025/12/28</td>
                            <td class="order-no">#1007288</td>
                            <td class="customer">ANA TORRES</td>
                            <td>PRD-2025-789</td>
                            <td>350 Á¢º</td>
                            <td>Âª£Â∑ûÂ∑•Âª†</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">üß™ ÊâìÊ®£ÈöéÊÆµ</div>
                                    <div class="stage-current">ÊâìÊ®£Ë£Ω‰Ωú‰∏≠</div>
                                </div>
                            </td>
                            <td><span class="days warning">6Â§©</span></td>
                            <td>Êï∏Á¢ºÂç∞Ëä±</td>
                            <td class="notes">Ë£Ω‰Ωú‰∏≠</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn" onclick="showActionModal('send', 'ÊâìÊ®£Ë£Ω‰Ωú‰∏≠', 'Ê®£ÂìÅÂæÖÁ¢∫Ë™ç', '#1007288')">‚Üí ÁôºÊ®£ÂìÅÁµ¶ÂúãÂ§ñ</button>
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007288')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-7">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤</div>
                                    <div class="timeline-horizontal">
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚úì</div></div>
                                            <div class="timeline-step-info"><div class="timeline-label">ÂúñÁ®øÈöéÊÆµ</div></div>
                                        </div>
                                        <div class="timeline-step current warning">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚öôÔ∏è</div></div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÊâìÊ®£Ë£Ω‰Ωú‰∏≠</div>
                                                <div class="timeline-meta"><div class="timeline-duration">ÈÄ≤Ë°å 6Â§© ‚ö†Ô∏è</div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Row 8: Ê®£ÂìÅ‰øÆÊîπ‰∏≠ -->
                        <tr class="yellow" onclick="toggleDetail(8, event)">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-8">‚ñ∂</span>
                            </td>
                            <td class="light">üü°</td>
                            <td class="order-date">2025/12/22</td>
                            <td class="order-no">#1007285</td>
                            <td class="customer">PEDRO GOMEZ</td>
                            <td>PRD-2025-234</td>
                            <td>550 Á¢º</td>
                            <td>Ê∑±Âú≥Â∑•Âª†</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">üß™ ÊâìÊ®£ÈöéÊÆµ</div>
                                    <div class="stage-current">Ê®£ÂìÅ‰øÆÊîπ‰∏≠</div>
                                </div>
                            </td>
                            <td><span class="days warning">5Â§©</span></td>
                            <td>Ê¥ªÊÄßÂç∞Ëä±</td>
                            <td class="notes">ÈáçÂÅöÊ®£ÂìÅ</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn" onclick="showActionModal('send', 'Ê®£ÂìÅ‰øÆÊîπ‰∏≠', 'Ê®£ÂìÅÂæÖÁ¢∫Ë™ç', '#1007285')">‚Üí ÈáçÊñ∞ÁôºÊ®£ÂìÅ</button>
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007285')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-8">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤ - Âê´‰øÆÊîπ</div>
                                    <div class="timeline-horizontal">
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚úì</div></div>
                                            <div class="timeline-step-info"><div class="timeline-label">Ê®£ÂìÅÂæÖÁ¢∫Ë™ç<br><span class="revision-tag">Á¨¨1Áâà</span></div></div>
                                        </div>
                                        <div class="timeline-step current warning">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">üîÑ</div></div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Ê®£ÂìÅ‰øÆÊîπ‰∏≠<br><span class="revision-tag">Á¨¨2Áâà</span></div>
                                                <div class="timeline-meta"><div class="timeline-duration">ÈÄ≤Ë°å 5Â§©</div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Row 9: Ê∫ñÂÇôÁîüÁî¢ -->
                        <tr onclick="toggleDetail(9, event)">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-9">‚ñ∂</span>
                            </td>
                            <td class="light">üü¢</td>
                            <td class="order-date">2026/01/05</td>
                            <td class="order-no">#1007297</td>
                            <td class="customer">LUCIA FERNANDEZ</td>
                            <td>PRD-2025-567</td>
                            <td>700 Á¢º</td>
                            <td>Êù±ËéûÂ∑•Âª†</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">üè≠ ÁîüÁî¢ÈöéÊÆµ</div>
                                    <div class="stage-current">Ê∫ñÂÇôÁîüÁî¢</div>
                                </div>
                            </td>
                            <td><span class="days">1Â§©</span></td>
                            <td>ÂÜ∞Áµ≤Âç∞Ëä±</td>
                            <td class="notes">Ê®£ÂìÅÂ∑≤Á¢∫Ë™ç</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn" onclick="showActionModal('start', 'Ê∫ñÂÇôÁîüÁî¢', 'ÁîüÁî¢‰∏≠', '#1007297')">‚Üí ÈñãÂßãÁîüÁî¢</button>
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007297')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-9">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤</div>
                                    <div class="timeline-horizontal">
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚úì</div></div>
                                            <div class="timeline-step-info"><div class="timeline-label">ÊâìÊ®£ÈöéÊÆµ</div></div>
                                        </div>
                                        <div class="timeline-step current">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚è±Ô∏è</div></div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Ê∫ñÂÇôÁîüÁî¢</div>
                                                <div class="timeline-meta"><div class="timeline-duration">Ê∫ñÂÇô 1Â§©</div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Row 10: ÁîüÁî¢‰∏≠ -->
                        <tr onclick="toggleDetail(10, event)">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-10">‚ñ∂</span>
                            </td>
                            <td class="light">üü¢</td>
                            <td class="order-date">2025/12/25</td>
                            <td class="order-no">#1007286</td>
                            <td class="customer">DIEGO RAMIREZ</td>
                            <td>PRD-2025-890</td>
                            <td>900 Á¢º</td>
                            <td>Âª£Â∑ûÂ∑•Âª†</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">üè≠ ÁîüÁî¢ÈöéÊÆµ</div>
                                    <div class="stage-current">ÁîüÁî¢‰∏≠</div>
                                </div>
                            </td>
                            <td><span class="days">10Â§©</span></td>
                            <td>Êï∏Á¢ºÂç∞Ëä±</td>
                            <td class="notes">ÁîüÁî¢ÈÄ≤Ë°å‰∏≠</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn" onclick="showActionModal('complete', 'ÁîüÁî¢‰∏≠', 'Â∑≤ÂÆåÊàê', '#1007286')">‚úì ÁîüÁî¢ÂÆåÊàê</button>
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007286')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-10">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤</div>
                                    <div class="timeline-horizontal">
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚úì</div></div>
                                            <div class="timeline-step-info"><div class="timeline-label">ÂâçÊúüÈöéÊÆµ</div></div>
                                        </div>
                                        <div class="timeline-step current">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚öôÔ∏è</div></div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">ÁîüÁî¢‰∏≠</div>
                                                <div class="timeline-meta"><div class="timeline-duration">ÈÄ≤Ë°å 10Â§©</div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Row 11: Â∑≤ÂÆåÊàê -->
                        <tr class="completed" onclick="toggleDetail(11, event)" style="display: none;">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-11">‚ñ∂</span>
                            </td>
                            <td class="light">üü¢</td>
                            <td class="order-date">2025/12/01</td>
                            <td class="order-no">#1007270</td>
                            <td class="customer">ELENA CASTRO</td>
                            <td>PRD-2025-345</td>
                            <td>400 Á¢º</td>
                            <td>Ê∑±Âú≥Â∑•Âª†</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">‚úÖ Â∑≤ÂÆåÊàê</div>
                                    <div class="stage-current">Â∑≤ÂÆåÊàê</div>
                                </div>
                            </td>
                            <td><span class="days">-</span></td>
                            <td>Ê¥ªÊÄßÂç∞Ëä±</td>
                            <td class="notes">Â∑≤‰∫§Ë≤®</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007270')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-11">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤</div>
                                    <div class="timeline-horizontal">
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚úì</div></div>
                                            <div class="timeline-step-info"><div class="timeline-label">ÂÖ®ÈÉ®ÊµÅÁ®ã</div></div>
                                        </div>
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚úì</div></div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Â∑≤ÂÆåÊàê</div>
                                                <div class="timeline-meta"><div class="timeline-date">ÂÆåÊàê 12/30</div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        
                        <!-- Row 12: Â∑≤ÂèñÊ∂à -->
                        <tr class="cancelled" onclick="toggleDetail(12, event)" style="display: none;">
                            <td class="expand-cell">
                                <span class="expand-btn" id="expand-12">‚ñ∂</span>
                            </td>
                            <td class="light">‚ö´</td>
                            <td class="order-date">2025/12/15</td>
                            <td class="order-no">#1007278</td>
                            <td class="customer">MIGUEL SANTOS</td>
                            <td>PRD-2025-678</td>
                            <td>650 Á¢º</td>
                            <td>Êù±ËéûÂ∑•Âª†</td>
                            <td>
                                <div class="stage-info">
                                    <div class="stage-major">‚ùå Â∑≤ÂèñÊ∂à</div>
                                    <div class="stage-current">Â∑≤ÂèñÊ∂à</div>
                                </div>
                            </td>
                            <td><span class="days">-</span></td>
                            <td>Êï∏Á¢ºÂç∞Ëä±</td>
                            <td class="notes">ÂÆ¢Êà∂ÂèñÊ∂à</td>
                            <td class="actions" onclick="event.stopPropagation()">
                                <div class="action-btns">
                                    <button class="btn secondary" onclick="showDetailsMenu('#1007278')">‚ãØ Ë©≥ÊÉÖ</button>
                                </div>
                            </td>
                        </tr>
                        <tr class="detail-row" id="detail-12">
                            <td colspan="13">
                                <div class="detail-content">
                                    <div class="timeline-title">üìä ÂÆåÊï¥ÊµÅÁ®ãÊ≠∑Âè≤</div>
                                    <div class="timeline-horizontal">
                                        <div class="timeline-step completed">
                                            <div class="timeline-dot-wrap"><div class="timeline-dot">‚úì</div></div>
                                            <div class="timeline-step-info"><div class="timeline-label">ÈÄ≤Ë°åÂà∞ÊâìÊ®£</div></div>
                                        </div>
                                        <div class="timeline-step">
                                            <div class="timeline-dot-wrap" style="background: var(--gray-bg); border-color: var(--gray);">
                                                <div class="timeline-dot" style="color: var(--gray);">‚úï</div>
                                            </div>
                                            <div class="timeline-step-info">
                                                <div class="timeline-label">Â∑≤ÂèñÊ∂à</div>
                                                <div class="timeline-meta"><div class="timeline-date">ÂèñÊ∂à 12/20</div></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Action Modal -->
    <div class="modal-overlay" id="actionModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">Á¢∫Ë™çÊìç‰Ωú</div>
            </div>
            <div class="modal-body">
                <div class="modal-info">
                    <span class="modal-info-text" id="modalInfo">Â∞áË®ÇÂñÆÂæû "Áï∂ÂâçÁãÄÊÖã" ËÆäÊõ¥ÁÇ∫ "‰∏ã‰∏ÄÁãÄÊÖã"</span>
                </div>
                
                <div class="modal-label">üìù ÂÇôË®ªÔºàÂèØÈÅ∏Ôºâ</div>
                <textarea class="modal-textarea" id="modalNote" placeholder="Ë®òÈåÑÁõ∏Èóú‰ø°ÊÅØ..."></textarea>
                <div class="modal-hint">üí° ÂèØ‰ª•Ë®òÈåÑÂÆ¢Êà∂Ë¶ÅÊ±Ç„ÄÅÊ≥®ÊÑè‰∫ãÈ†ÖÁ≠â</div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal()">ÂèñÊ∂à</button>
                <button class="modal-btn confirm" id="confirmBtn" onclick="confirmAction()">‚úì Á¢∫Ë™ç</button>
            </div>
        </div>
    </div>
    
    <!-- Details Menu Modal -->
    <div class="modal-overlay" id="detailsModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Ë®ÇÂñÆÊìç‰ΩúÈÅ∏ÂñÆ</div>
            </div>
            <div class="modal-body">
                <div class="menu-option" onclick="showNoteModal()">
                    <div class="menu-icon">üìù</div>
                    <div class="menu-text">
                        <div class="menu-label">Ê∑ªÂä†ÂÇôË®ª</div>
                        <div class="menu-desc">Ë®òÈåÑÁõ∏Èóú‰ø°ÊÅØ</div>
                    </div>
                </div>
                
                <div class="menu-option" onclick="showDeliveryDateModal()">
                    <div class="menu-icon">üìÖ</div>
                    <div class="menu-text">
                        <div class="menu-label">Ë®≠ÂÆö‰∫§Ë≤®Êó•Êúü</div>
                        <div class="menu-desc">Ë®≠ÂÆöÊàñ‰øÆÊîπÈ†êË®à‰∫§Ë≤®ÊôÇÈñì</div>
                    </div>
                </div>
                
                <div class="menu-option" id="skipSamplingOption" style="display:none;" onclick="showSkipSamplingModal()">
                    <div class="menu-icon">‚ö°</div>
                    <div class="menu-text">
                        <div class="menu-label">Ë∑≥ÈÅéÊâìÊ®£ÔºåÁõ¥ÈÄöÁîüÁî¢</div>
                        <div class="menu-desc">ÈÅ©ÂêàËÄÅÂÆ¢Êà∂ÈáçË§áË®ÇÂñÆ</div>
                    </div>
                </div>
                
                <div class="menu-option" onclick="showBackStepModal()">
                    <div class="menu-icon">üîÑ</div>
                    <div class="menu-text">
                        <div class="menu-label">ÈÄÄÂõûÂà∞‰πãÂâçÊ≠•È©ü</div>
                        <div class="menu-desc">ÈÅ∏ÊìáË¶ÅÈÄÄÂõûÁöÑÁãÄÊÖã</div>
                    </div>
                </div>
                
                <div class="menu-option danger" onclick="showCancelOrderModal()">
                    <div class="menu-icon">‚ùå</div>
                    <div class="menu-text">
                        <div class="menu-label">ÂèñÊ∂àË®ÇÂñÆ</div>
                        <div class="menu-desc">ÁµÇÊ≠¢Ê≠§Ë®ÇÂñÆ</div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="closeModal()">ÈóúÈñâ</button>
            </div>
        </div>
    </div>
    
    <!-- Back Step Selection Modal -->
    <div class="modal-overlay" id="backStepModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">ÈÅ∏ÊìáË¶ÅÈÄÄÂõûÁöÑÊ≠•È©ü</div>
            </div>
            <div class="modal-body">
                <div class="modal-info">
                    <span class="modal-info-text">Áï∂ÂâçÁãÄÊÖãÔºö<strong id="currentStatusText">Ê®£ÂìÅÂæÖÁ¢∫Ë™ç</strong></span>
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <div style="font-size: 0.8rem; color: var(--text-3); margin-bottom: 0.75rem;">ÈÅ∏ÊìáË¶ÅÈÄÄÂõûÂà∞ÁöÑÊ≠•È©üÔºö</div>
                    
                    <label class="back-step-option">
                        <input type="radio" name="backStep" value="ÊâìÊ®£Ë£Ω‰Ωú‰∏≠">
                        <div class="back-step-info">
                            <div class="back-step-name">ÊâìÊ®£Ë£Ω‰Ωú‰∏≠</div>
                            <div class="back-step-desc">ÈáçÊñ∞Ë£Ω‰ΩúÊ®£ÂìÅ</div>
                        </div>
                    </label>
                    
                    <label class="back-step-option">
                        <input type="radio" name="backStep" value="Ê∫ñÂÇôÊâìÊ®£">
                        <div class="back-step-info">
                            <div class="back-step-name">Ê∫ñÂÇôÊâìÊ®£</div>
                            <div class="back-step-desc">ÈáçÊñ∞Ê∫ñÂÇôÊâìÊ®£</div>
                        </div>
                    </label>
                    
                    <label class="back-step-option">
                        <input type="radio" name="backStep" value="ÂúñÁ®øÂæÖÁ¢∫Ë™ç">
                        <div class="back-step-info">
                            <div class="back-step-name">ÂúñÁ®øÂæÖÁ¢∫Ë™ç</div>
                            <div class="back-step-desc">ÈúÄË¶ÅÈáçÊñ∞ÂÅöÂúñ</div>
                        </div>
                    </label>
                </div>
                
                <div class="modal-label">üìù ÈÄÄÂõûÂéüÂõ†ÔºàÂª∫Ë≠∞Â°´ÂØ´Ôºâ</div>
                <textarea class="modal-textarea" id="backStepNote" placeholder="Ë™™ÊòéÁÇ∫‰ªÄÈ∫ºË¶ÅÈÄÄÂõû..."></textarea>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="backToDetailsMenu()">‚Üê ËøîÂõû</button>
                <button class="modal-btn confirm" onclick="confirmBackStep()">‚úì Á¢∫Ë™çÈÄÄÂõû</button>
            </div>
        </div>
    </div>
    
    <!-- Add Note Modal -->
    <div class="modal-overlay" id="noteModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Ê∑ªÂä†ÂÇôË®ª</div>
            </div>
            <div class="modal-body">
                <div class="modal-info">
                    <span class="modal-info-text">Ë®ÇÂñÆ <strong id="noteOrderId">#1007273</strong></span>
                </div>
                
                <div class="modal-label">üìù ÂÇôË®ªÂÖßÂÆπ</div>
                <textarea class="modal-textarea" id="noteText" placeholder="Ëº∏ÂÖ•ÂÇôË®ª‰ø°ÊÅØ..."></textarea>
                <div class="modal-hint">üí° ÂÇôË®ªÊúÉÈ°ØÁ§∫Âú®ÊôÇÈñìËª∏‰∏ä</div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="backToDetailsMenu()">‚Üê ËøîÂõû</button>
                <button class="modal-btn confirm" onclick="confirmAddNote()">‚úì Ê∑ªÂä†</button>
            </div>
        </div>
    </div>
    
    <!-- Delivery Date Modal -->
    <div class="modal-overlay" id="deliveryDateModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Ë®≠ÂÆö‰∫§Ë≤®Êó•Êúü</div>
            </div>
            <div class="modal-body">
                <div class="modal-info">
                    <span class="modal-info-text">Ë®ÇÂñÆ <strong id="deliveryOrderId">#1007273</strong></span>
                </div>
                
                <div class="modal-label">üìÖ È†êË®à‰∫§Ë≤®Êó•Êúü</div>
                <input type="date" class="modal-textarea" id="deliveryDate" style="min-height: auto; padding: 0.75rem;">
                <div class="modal-hint">üí° ÂèØ‰ª•Èö®ÊôÇ‰øÆÊîπ</div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="backToDetailsMenu()">‚Üê ËøîÂõû</button>
                <button class="modal-btn confirm" onclick="confirmDeliveryDate()">‚úì Ë®≠ÂÆö</button>
            </div>
        </div>
    </div>
    
    <!-- Skip Sampling Modal -->
    <div class="modal-overlay" id="skipSamplingModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">‚ö†Ô∏è Á¢∫Ë™çË∑≥ÈÅéÊâìÊ®£ÈöéÊÆµ</div>
            </div>
            <div class="modal-body">
                <div class="modal-info">
                    <div style="color: var(--text-2);">Â∞áÁõ¥Êé•Âæû <strong>ÂúñÁ®øÂæÖÁ¢∫Ë™ç</strong> ÈÄ≤ÂÖ• <strong style="color: var(--blue);">Ê∫ñÂÇôÁîüÁî¢</strong></div>
                </div>
                
                <div class="modal-label">üìù Ë∑≥ÈÅéÂéüÂõ†ÔºàÂèØÈÅ∏Ôºâ</div>
                <textarea class="modal-textarea" id="skipReason" placeholder="‰æãÂ¶ÇÔºöËÄÅÂÆ¢Êà∂ÈáçË§áË®ÇÂñÆ..."></textarea>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="backToDetailsMenu()">‚Üê ËøîÂõû</button>
                <button class="modal-btn confirm" onclick="confirmSkipSampling()">‚úì Á¢∫Ë™çË∑≥ÈÅé</button>
            </div>
        </div>
    </div>
    
    <!-- Cancel Order Modal -->
    <div class="modal-overlay" id="cancelOrderModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">‚ö†Ô∏è Á¢∫Ë™çÂèñÊ∂àË®ÇÂñÆ</div>
            </div>
            <div class="modal-body">
                <div class="modal-info" style="background: var(--red-bg); border-left: 3px solid var(--red);">
                    <span style="color: var(--red); font-weight: 600;">Ê≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Âæ©ÔºÅ</span>
                </div>
                
                <div class="modal-label">üìù ÂèñÊ∂àÂéüÂõ†ÔºàÂøÖÂ°´Ôºâ</div>
                <textarea class="modal-textarea" id="cancelReason" placeholder="Ë´ãË™™ÊòéÂèñÊ∂àÂéüÂõ†..." required></textarea>
            </div>
            <div class="modal-footer">
                <button class="modal-btn cancel" onclick="backToDetailsMenu()">‚Üê ËøîÂõû</button>
                <button class="modal-btn danger" onclick="confirmCancelOrder()">‚ùå Á¢∫Ë™çÂèñÊ∂àË®ÇÂñÆ</button>
            </div>
        </div>
    </div>
    
    <script>
        let currentAction = '';
        let currentOrderId = '';
        let fromStatus = '';
        let toStatus = '';
        
        function showActionModal(action, from, to, orderId) {
            currentAction = action;
            currentOrderId = orderId;
            fromStatus = from;
            toStatus = to;
            
            const modal = document.getElementById('actionModal');
            const title = document.getElementById('modalTitle');
            const info = document.getElementById('modalInfo');
            const confirmBtn = document.getElementById('confirmBtn');
            const noteField = document.getElementById('modalNote');
            
            // Reset note field
            noteField.value = '';
            
            // Set content based on action type
            if (action === 'confirm') {
                title.textContent = 'Á¢∫Ë™çÔºöÂúãÂ§ñÁ¢∫Ë™ç';
                info.textContent = `Ë®ÇÂñÆ ${orderId}`;
                const arrow = document.createElement('div');
                arrow.style.display = 'flex';
                arrow.style.alignItems = 'center';
                arrow.style.gap = '0.5rem';
                arrow.style.marginTop = '0.5rem';
                arrow.innerHTML = `<span style="color: var(--text-2);">${from}</span> <span style="color: var(--text-3); font-weight: 600;">‚Üí</span> <span style="color: var(--blue); font-weight: 600;">${to}</span>`;
                info.parentElement.appendChild(arrow);
                confirmBtn.textContent = '‚úì Á¢∫Ë™ç';
                confirmBtn.className = 'modal-btn confirm';
            } else if (action === 'revise') {
                title.textContent = 'Á¢∫Ë™çÔºöÈúÄË¶Å‰øÆÊîπ';
                info.textContent = `Ë®ÇÂñÆ ${orderId}`;
                const arrow = document.createElement('div');
                arrow.style.display = 'flex';
                arrow.style.alignItems = 'center';
                arrow.style.gap = '0.5rem';
                arrow.style.marginTop = '0.5rem';
                arrow.innerHTML = `<span style="color: var(--text-2);">${from}</span> <span style="color: var(--text-3); font-weight: 600;">‚Üí</span> <span style="color: var(--yellow); font-weight: 600;">${to}</span>`;
                info.parentElement.appendChild(arrow);
                confirmBtn.textContent = 'üîÑ Á¢∫Ë™ç‰øÆÊîπ';
                confirmBtn.className = 'modal-btn confirm';
                noteField.placeholder = 'Âª∫Ë≠∞Ë™™Êòé‰øÆÊîπÂéüÂõ†...';
            } else if (action === 'send') {
                title.textContent = 'Á¢∫Ë™çÔºöÈáçÊñ∞ÁôºÂúñÁµ¶ÂúãÂ§ñ';
                info.textContent = `Ë®ÇÂñÆ ${orderId}`;
                const arrow = document.createElement('div');
                arrow.style.display = 'flex';
                arrow.style.alignItems = 'center';
                arrow.style.gap = '0.5rem';
                arrow.style.marginTop = '0.5rem';
                arrow.innerHTML = `<span style="color: var(--text-2);">${from}</span> <span style="color: var(--text-3); font-weight: 600;">‚Üí</span> <span style="color: var(--blue); font-weight: 600;">${to}</span>`;
                info.parentElement.appendChild(arrow);
                confirmBtn.textContent = '‚Üí Á¢∫Ë™çÁôºÂúñ';
                confirmBtn.className = 'modal-btn confirm';
            } else if (action === 'start') {
                title.textContent = 'Á¢∫Ë™çÔºöÈñãÂßã‰∏ã‰∏ÄÊ≠•';
                info.textContent = `Ë®ÇÂñÆ ${orderId}`;
                const arrow = document.createElement('div');
                arrow.style.display = 'flex';
                arrow.style.alignItems = 'center';
                arrow.style.gap = '0.5rem';
                arrow.style.marginTop = '0.5rem';
                arrow.innerHTML = `<span style="color: var(--text-2);">${from}</span> <span style="color: var(--text-3); font-weight: 600;">‚Üí</span> <span style="color: var(--blue); font-weight: 600;">${to}</span>`;
                info.parentElement.appendChild(arrow);
                confirmBtn.textContent = '‚úì Á¢∫Ë™çÈñãÂßã';
                confirmBtn.className = 'modal-btn confirm';
            } else if (action === 'complete') {
                title.textContent = 'Á¢∫Ë™çÔºöÁîüÁî¢ÂÆåÊàê';
                info.textContent = `Ë®ÇÂñÆ ${orderId}`;
                const arrow = document.createElement('div');
                arrow.style.display = 'flex';
                arrow.style.alignItems = 'center';
                arrow.style.gap = '0.5rem';
                arrow.style.marginTop = '0.5rem';
                arrow.innerHTML = `<span style="color: var(--text-2);">${from}</span> <span style="color: var(--text-3); font-weight: 600;">‚Üí</span> <span style="color: var(--green); font-weight: 600;">${to}</span>`;
                info.parentElement.appendChild(arrow);
                confirmBtn.textContent = '‚úì Á¢∫Ë™çÂÆåÊàê';
                confirmBtn.className = 'modal-btn confirm';
            } else if (action === 'skip') {
                title.textContent = '‚ö†Ô∏è Á¢∫Ë™çË∑≥ÈÅéÊâìÊ®£ÈöéÊÆµ';
                info.textContent = `Â∞áÁõ¥Êé•ÂæûÁï∂ÂâçÈöéÊÆµÈÄ≤ÂÖ•ÁîüÁî¢ÈöéÊÆµ`;
                confirmBtn.textContent = '‚úì Á¢∫Ë™çË∑≥ÈÅé';
                confirmBtn.className = 'modal-btn confirm';
            }
            
            modal.classList.add('show');
        }
        
        function showDetailsMenu(orderId) {
            currentOrderId = orderId;
            const modal = document.getElementById('detailsModal');
            modal.classList.add('show');
        }
        
        function closeModal() {
            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.classList.remove('show');
            });
            
            // Clean up any dynamically added elements
            const modalInfo = document.getElementById('modalInfo');
            if (modalInfo) {
                const modalInfoParent = modalInfo.parentElement;
                const arrows = modalInfoParent.querySelectorAll('div');
                arrows.forEach((el, index) => {
                    if (index > 0) el.remove();
                });
            }
        }
        
        function confirmAction() {
            const note = document.getElementById('modalNote').value;
            
            // Here you would send the data to your backend
            console.log('Action:', currentAction);
            console.log('Order ID:', currentOrderId);
            console.log('From:', fromStatus);
            console.log('To:', toStatus);
            console.log('Note:', note);
            
            // Show success message (you can implement this)
            alert(`Êìç‰ΩúÊàêÂäüÔºÅ\nË®ÇÂñÆ ${currentOrderId} Â∑≤Âæû "${fromStatus}" ËÆäÊõ¥ÁÇ∫ "${toStatus}"`);
            
            closeModal();
            
            // Reload or update the page data
            // location.reload();
        }
        
        // New modal functions
        function showNoteModal() {
            closeModal();
            document.getElementById('noteOrderId').textContent = currentOrderId;
            document.getElementById('noteModal').classList.add('show');
        }
        
        function confirmAddNote() {
            const note = document.getElementById('noteText').value;
            if (note.trim()) {
                console.log('Add note for', currentOrderId, ':', note);
                alert('ÂÇôË®ªÂ∑≤Ê∑ªÂä†');
                closeModal();
            } else {
                alert('Ë´ãËº∏ÂÖ•ÂÇôË®ªÂÖßÂÆπ');
            }
        }
        
        function showDeliveryDateModal() {
            closeModal();
            document.getElementById('deliveryOrderId').textContent = currentOrderId;
            // Set default date
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            document.getElementById('deliveryDate').valueAsDate = tomorrow;
            document.getElementById('deliveryDateModal').classList.add('show');
        }
        
        function confirmDeliveryDate() {
            const date = document.getElementById('deliveryDate').value;
            if (date) {
                console.log('Set delivery date for', currentOrderId, ':', date);
                alert(`È†êË®à‰∫§Ë≤®Êó•ÊúüÂ∑≤Ë®≠ÂÆöÁÇ∫Ôºö${date}`);
                closeModal();
            } else {
                alert('Ë´ãÈÅ∏ÊìáÊó•Êúü');
            }
        }
        
        function showSkipSamplingModal() {
            closeModal();
            document.getElementById('skipSamplingModal').classList.add('show');
        }
        
        function confirmSkipSampling() {
            const reason = document.getElementById('skipReason').value;
            console.log('Skip sampling for', currentOrderId, 'Reason:', reason);
            alert('Â∑≤Ë∑≥ÈÅéÊâìÊ®£ÈöéÊÆµÔºåÈÄ≤ÂÖ•ÁîüÁî¢ÈöéÊÆµ');
            closeModal();
        }
        
        function showBackStepModal() {
            closeModal();
            document.getElementById('backStepModal').classList.add('show');
        }
        
        function backToDetailsMenu() {
            closeModal();
            document.getElementById('detailsModal').classList.add('show');
        }
        
        function confirmBackStep() {
            const selectedStep = document.querySelector('input[name="backStep"]:checked');
            const note = document.getElementById('backStepNote').value;
            
            if (selectedStep) {
                console.log('Back to:', selectedStep.value, 'Note:', note);
                alert(`Â∑≤ÈÄÄÂõûÂà∞Ôºö${selectedStep.value}`);
                closeModal();
            } else {
                alert('Ë´ãÈÅ∏ÊìáË¶ÅÈÄÄÂõûÁöÑÊ≠•È©ü');
            }
        }
        
        function showCancelOrderModal() {
            closeModal();
            document.getElementById('cancelOrderModal').classList.add('show');
        }
        
        function confirmCancelOrder() {
            const reason = document.getElementById('cancelReason').value;
            if (reason && reason.trim()) {
                if (confirm(`Á¢∫ÂÆöË¶ÅÂèñÊ∂àË®ÇÂñÆ ${currentOrderId} ÂóéÔºü\nÂéüÂõ†Ôºö${reason}`)) {
                    console.log('Cancel order', currentOrderId, 'Reason:', reason);
                    alert('Ë®ÇÂñÆÂ∑≤ÂèñÊ∂à');
                    closeModal();
                }
            } else {
                alert('ÂèñÊ∂àË®ÇÂñÆÈúÄË¶ÅÂ°´ÂØ´ÂéüÂõ†');
            }
        }
        
        function toggleCompletedOrders(checkbox) {
            const completedRows = document.querySelectorAll('tr.completed');
            completedRows.forEach(row => {
                if (!row.classList.contains('detail-row')) {
                    row.style.display = checkbox.checked ? '' : 'none';
                }
            });
        }
        
        function toggleCancelledOrders(checkbox) {
            const cancelledRows = document.querySelectorAll('tr.cancelled');
            cancelledRows.forEach(row => {
                if (!row.classList.contains('detail-row')) {
                    row.style.display = checkbox.checked ? '' : 'none';
                }
            });
        }
        
        function toggleSummaryDetails(id) {
            const summary = event.currentTarget;
            const details = document.getElementById(`summary-details-${id}`);
            
            summary.classList.toggle('collapsed');
            summary.classList.toggle('expanded');
            details.classList.toggle('show');
        }
        
        function editDeliveryDate(orderId) {
            currentOrderId = orderId;
            showDeliveryDateModal();
        }
        
        function editCurrentNote() {
            showNoteModal();
        }
        
        function goBackToStage() {
            showBackStepModal();
        }
        
        // Close modal when clicking outside
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    closeModal();
                }
            });
        });
        
        // Step menu functions
        function toggleStepMenu(event, menuId) {
            event.stopPropagation();
            const menu = document.getElementById(`step-menu-${menuId}`);
            const allMenus = document.querySelectorAll('.step-action-menu');
            
            // Close all other menus
            allMenus.forEach(m => {
                if (m !== menu) m.classList.remove('show');
            });
            
            // Toggle current menu
            menu.classList.toggle('show');
        }
        
        // Toggle detailed timeline
        function toggleDetailedTimeline(orderId) {
            const detailed = document.getElementById(`timeline-detailed-${orderId}`);
            const button = document.getElementById(`toggle-btn-${orderId}`);
            
            if (detailed.classList.contains('show')) {
                // Collapse
                detailed.classList.remove('show');
                button.innerHTML = 'üìã Êü•ÁúãË©≥Á¥∞Ë®òÈåÑ';
            } else {
                // Expand
                detailed.classList.add('show');
                button.innerHTML = '‚úï Êî∂Ëµ∑Ë©≥Á¥∞Ë®òÈåÑ';
                
                // Simulate loading from backend
                console.log('Loading detailed history for order:', orderId);
                // In real app: await fetch(`/api/orders/${orderId}/history`)
            }
        }
        
        // Close step menus when clicking outside
        document.addEventListener('click', () => {
            document.querySelectorAll('.step-action-menu').forEach(menu => {
                menu.classList.remove('show');
            });
        });
        
        function editStepNote(stepName, orderId, stepId) {
            console.log('Edit note for:', stepName, orderId, stepId);
            // Close step menu
            document.querySelectorAll('.step-action-menu').forEach(m => m.classList.remove('show'));
            
            // Show edit note modal (reuse existing note modal)
            currentOrderId = '#100727' + orderId;
            showNoteModal();
        }
        
        function backToStep(stepName, orderId, stepId) {
            console.log('Back to:', stepName, orderId, stepId);
            // Close step menu
            document.querySelectorAll('.step-action-menu').forEach(m => m.classList.remove('show'));
            
            if (confirm(`Á¢∫ÂÆöË¶ÅÈÄÄÂõûÂà∞ "${stepName}" ÂóéÔºü\n\nË´ãÂú®‰∏ã‰∏ÄÊ≠•Â°´ÂØ´ÈÄÄÂõûÂéüÂõ†„ÄÇ`)) {
                // Show back step modal with this step pre-selected
                alert(`ÈÄÄÂõûÂäüËÉΩÔºöÂ∞áÂõûÂà∞ "${stepName}"\n\nÂØ¶ÈöõÊáâÁî®‰∏≠ÊúÉË™øÁî® API Êõ¥Êñ∞Ë≥áÊñôÂ∫´`);
            }
        }
        
        function undoLastStep(orderId, rowId, stepId) {
            console.log('Undo last step:', orderId, rowId, stepId);
            // Close step menu
            document.querySelectorAll('.step-action-menu').forEach(m => m.classList.remove('show'));
            
            const reason = prompt('Ë´ãËº∏ÂÖ•Êí§Èä∑ÂéüÂõ†ÔºàÂøÖÂ°´ÔºâÔºö');
            if (reason && reason.trim()) {
                if (confirm(`Á¢∫ÂÆöË¶ÅÊí§Èä∑ÊúÄÂæå‰∏ÄÊ≠•Êìç‰ΩúÂóéÔºü\n\nÂéüÂõ†Ôºö${reason}`)) {
                    console.log('Undo:', orderId, 'Reason:', reason);
                    alert('Êí§Èä∑ÊàêÂäüÔºÅ\n\nÂØ¶ÈöõÊáâÁî®‰∏≠ÊúÉË™øÁî® API ËªüÂà™Èô§Ë®òÈåÑ');
                }
            } else if (reason !== null) {
                alert('Êí§Èä∑Êìç‰ΩúÈúÄË¶ÅÂ°´ÂØ´ÂéüÂõ†');
            }
        }
        
        // Original functions (keep existing)
        function toggleDetail(id, event) {
            // Prevent row click when clicking action buttons
            if (event && event.target.closest('.actions')) {
                return;
            }
            
            const detailRow = document.getElementById(`detail-${id}`);
            const expandBtn = document.getElementById(`expand-${id}`);
            
            if (detailRow.classList.contains('show')) {
                detailRow.classList.remove('show');
                expandBtn.classList.remove('expanded');
            } else {
                // Close all others
                document.querySelectorAll('.detail-row').forEach(row => {
                    row.classList.remove('show');
                });
                document.querySelectorAll('.expand-btn').forEach(btn => {
                    btn.classList.remove('expanded');
                });
                
                // Open this one
                detailRow.classList.add('show');
                expandBtn.classList.add('expanded');
            }
        }
        
        function toggleSubstatus(stage) {
            const dropdown = document.getElementById(`dropdown-${stage}`);
            const allDropdowns = document.querySelectorAll('.substatus-dropdown');
            
            // Close all other dropdowns
            allDropdowns.forEach(d => {
                if (d !== dropdown) {
                    d.classList.remove('show');
                }
            });
            
            // Toggle current dropdown
            dropdown.classList.toggle('show');
            
            event.stopPropagation();
        }
        
        // Close dropdowns when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.stage-filter')) {
                document.querySelectorAll('.substatus-dropdown').forEach(d => {
                    d.classList.remove('show');
                });
            }
        });
        
        // Substatus option click
        document.querySelectorAll('.substatus-option').forEach(option => {
            option.addEventListener('click', function() {
                const dropdown = this.closest('.substatus-dropdown');
                dropdown.querySelectorAll('.substatus-option').forEach(o => {
                    o.classList.remove('active');
                });
                this.classList.add('active');
            });
        });
    </script>
</body>
</html>